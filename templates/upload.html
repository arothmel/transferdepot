<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Group {{ group }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
</head>
<body>
  <div class="topbar">
    <a class="btn" href="/">Home</a>
    <a class="btn" href="/admin/health">Admin Health</a>
    <a class="btn" href="/admin/dev-api">Dev API</a>
  </div>

  <main>
    {% set control_groups = groups | reject('equalto', 'SHIRE_GATEWAY') | list %}

    <section class="group-block">
      <h2>TransferDepot</h2>
      {% if control_groups %}
        <div class="group-buttons">
        {% for name in control_groups %}
          <a class="group-button{% if name == group %} group-button--active{% endif %}" href="/{{ name }}">{{ name }}</a>
        {% endfor %}
        </div>
      {% else %}
        <p><em>No groups configured.</em></p>
      {% endif %}
    </section>

    <section class="group-block upload-block">
      <h2>Group: {{ group }}</h2>

      {% if is_gateway %}
      <section class="gateway-callout">
        <h3>Sh1re Gateway Uploads</h3>
        <p>Welcome, Sh1re operators. Please stay on this page while the gateway processes your transfer so we can keep the queue orderly.</p>
        <p>Your upload is important to us. Weâ€™re watching the gateway closely and will nudge it if things slow down.</p>
        <button type="button" class="btn-secondary" onclick="window.location.href='{{ url_for('ui.index') }}'">Cancel and return home</button>
        <p class="gateway-note">Control Room staff should keep using the standard SCT and TTCS upload paths.</p>
      </section>
      {% endif %}

      <form method="post" enctype="multipart/form-data" class="upload-form">
        <input type="file" name="file">
        <input type="submit" value="Upload">
      </form>

      <h3>Files</h3>
      {% if files %}
      <ul>
        {% for f in files %}
          <li><a href="{{ url_for('api_v1.download', group=group, fname=f) }}">{{ f }}</a></li>
        {% endfor %}
      </ul>
      {% else %}
      <p>No files uploaded yet.</p>
      {% endif %}
    </section>

    <section class="group-block">
      <h2>Power Users</h2>
      <p>POST directly to <code>/api/v1/upload/{{ group }}</code> or explore the <a href="/admin/dev-api">Dev API door</a>.</p>
    </section>
  </main>
</body>
</html>
